# API –¥–æ—Å—Ç—É–ø–µ–Ω –ø—É–±–ª–∏—á–Ω–æ! üöÄ

## –ü—É–±–ª–∏—á–Ω—ã–π URL

**API –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É:** `http://89.169.170.231:8000`

## Endpoints

### 1. Health Check
```bash
curl http://89.169.170.231:8000/
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "status": "ok",
  "service": "AmWine Recommendations API",
  "version": "1.0.0"
}
```

### 2. –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
```bash
curl -X POST "http://89.169.170.231:8000/offers/recommend" \
  -H "Content-Type: application/json" \
  -d '{
    "occasion": "üéâ –í–µ—á–µ—Ä–∏–Ω–∫–∞",
    "style": "üå§ –õ–µ–≥–∫–æ –∏ –º—è–≥–∫–æ",
    "drink_types": ["üç∑ –í–∏–Ω–æ / –∏–≥—Ä–∏—Å—Ç–æ–µ", "üç∫ –ü–∏–≤–æ / —Å–∏–¥—Ä"],
    "tastes": ["üçë –§—Ä—É–∫—Ç–æ–≤–æ–µ / –∞—Ä–æ–º–∞—Ç–Ω–æ–µ", "üç¨ –°–ª–∞–¥–∫–æ–≤–∞—Ç–æ–µ"],
    "people_count": 6,
    "budget": "üí∞ 1000‚Äì3000 ‚ÇΩ"
  }'
```

### 3. –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **Swagger UI:** http://89.169.170.231:8000/docs
- **ReDoc:** http://89.169.170.231:8000/redoc

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

### JavaScript / TypeScript

```typescript
const response = await fetch('http://89.169.170.231:8000/offers/recommend', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({
    occasion: "üéâ –í–µ—á–µ—Ä–∏–Ω–∫–∞",
    style: "üå§ –õ–µ–≥–∫–æ –∏ –º—è–≥–∫–æ",
    drink_types: ["üç∑ –í–∏–Ω–æ / –∏–≥—Ä–∏—Å—Ç–æ–µ"],
    tastes: ["üçë –§—Ä—É–∫—Ç–æ–≤–æ–µ / –∞—Ä–æ–º–∞—Ç–Ω–æ–µ"],
    people_count: 6,
    budget: "üí∞ 1000‚Äì3000 ‚ÇΩ"
  })
});

const data = await response.json();
console.log(data.offers); // Array of 10 products
```

### React Native / Expo

```typescript
import axios from 'axios';

const getRecommendations = async (quizData) => {
  try {
    const response = await axios.post(
      'http://89.169.170.231:8000/offers/recommend',
      quizData
    );
    return response.data.offers;
  } catch (error) {
    console.error('Error fetching recommendations:', error);
    throw error;
  }
};

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
const offers = await getRecommendations({
  occasion: "üéâ –í–µ—á–µ—Ä–∏–Ω–∫–∞",
  style: "üå§ –õ–µ–≥–∫–æ –∏ –º—è–≥–∫–æ",
  drink_types: ["üç∑ –í–∏–Ω–æ / –∏–≥—Ä–∏—Å—Ç–æ–µ"],
  tastes: ["üçë –§—Ä—É–∫—Ç–æ–≤–æ–µ / –∞—Ä–æ–º–∞—Ç–Ω–æ–µ"],
  people_count: 6,
  budget: "üí∞ 1000‚Äì3000 ‚ÇΩ"
});
```

## –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞

```json
{
  "offers": [
    {
      "id": "SKU123",
      "description": "–ù–∞–∑–≤–∞–Ω–∏–µ –≤–∏–Ω–∞",
      "image": "https://url-to-image.jpg",
      "url": "https://product-page-url",
      "price_raw": "999 ‚ÇΩ"
    }
    // ... –µ—â–µ 9 —Ç–æ–≤–∞—Ä–æ–≤
  ]
}
```

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

‚ö†Ô∏è **–í–∞–∂–Ω–æ:**
- API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã, —Ç.–∫. –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–∫–∞ –ø—É—Å—Ç–∞—è
- –ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –ë–î (—á–µ—Ä–µ–∑ `db/update_products.py`) API –±—É–¥–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã
- ML-—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–∑–∂–µ –≤ –º–æ–¥—É–ª–µ `ml/recsys`

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–º

API –∑–∞–ø—É—â–µ–Ω –∫–∞–∫ systemd service –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—Ç–∞—Ä—Ç—É–µ—Ç –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å–µ—Ä–≤–µ—Ä–∞.

**–ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞:**
```bash
sudo systemctl status amwine-api
```

**–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤:**
```bash
sudo journalctl -u amwine-api -f
```

**–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫:**
```bash
sudo systemctl restart amwine-api
```

**–û—Å—Ç–∞–Ω–æ–≤–∫–∞:**
```bash
sudo systemctl stop amwine-api
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤ Yandex Cloud

–ï—Å–ª–∏ API –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ –∏–∑–≤–Ω–µ, –æ—Ç–∫—Ä–æ–π—Ç–µ –ø–æ—Ä—Ç 8000 –≤ –≥—Ä—É–ø–ø–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:

1. –ó–∞–π–¥–∏—Ç–µ –≤ Yandex Cloud Console
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à—É VM (alco-vm)
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "–ì—Ä—É–ø–ø—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏"
4. –î–æ–±–∞–≤—å—Ç–µ –ø—Ä–∞–≤–∏–ª–æ:
   - **–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –í—Ö–æ–¥—è—â–∏–π —Ç—Ä–∞—Ñ–∏–∫
   - **–ü—Ä–æ—Ç–æ–∫–æ–ª:** TCP
   - **–ü–æ—Ä—Ç:** 8000
   - **CIDR:** 0.0.0.0/0 (–∏–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ IP –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ API –∑–∞–ø—É—â–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –ø—É–±–ª–∏—á–Ω–æ
2. üìù –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ç–æ–≤–∞—Ä—ã –≤ –ë–î —á–µ—Ä–µ–∑ `db/update_products.py`
3. üß™ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∏–∑ –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
4. ü§ñ –î–æ–±–∞–≤—å—Ç–µ ML-–º–æ–¥–µ–ª—å –¥–ª—è —É–º–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
